{
  "project_id": "jwe_test",
  "project_name": "SAS to Python Code Conversion",
  "environment": "development",
  "modules": [
    {
      "module_type": "jwt_config",
      "name": "auth2",
      "config": {
        "id": "jwt-config",
        "service_url": "${environments.${environment}.urls.jwt_service_url}",
        "claims": {
          "static": {
            "key": "jwe_test-consumer-key",
            "environment": "${environment}",
            "exp_hours": 1,
            "groq_api_key": "${environments.common.secrets.groq_api_key}"            
          }
        }
      }
    },
    {
      "module_type": "jwt_config",
      "name": "auth",
      "config": {
        "id": "jwe-config",
        "service_url": "${environments.${environment}.urls.jwt_service_url}",
        "jwe_config": {
          "enabled": true,
          "encryption_key": "-secret-length-must-be-32-chars-",
          "algorithm": "dir",
          "encryption": "A256GCM",
          "compression": null
        },        
        "claims": {
          "static": {
            "key": "jwe_test_consumer_key",
            "environment": "${environment}",
            "exp_hours": 1,
            "groq_api_key": "${environments.common.secrets.groq_api_key}"            
          }
        }
      }
    },    
    {
      "module_type": "inference_endpoint",
      "name": "openai-compatible",
      "config": {
        "model_name": "llama-3.1-70b-versatile",
        "endpoint_url": "${environments.${environment}.urls.api_base_url}/jwe_test/v1/chat/completions",
        "description": "OpenAI-compatible endpoint with no predefined prompt template - accepts full OpenAI chat completion requests"
      }
    },
    {
      "module_type": "api_gateway",
      "name": "apisix-openai-route",
      "dependencies": ["openai-compatible", "simple-auth", "langfuse-observability"],
      "config": {
        "gateway_type": "apisix",
        "consumer": {
          "username": "jwe-consumer",
          "plugins": {
            "jwe-decrypt": {
                "key": "jwe_test_consumer_key",
                "secret": "-secret-length-must-be-32-chars-"
            }
          }
        },
        "routes": [
          {
            "name": "openai-chat-completions",
            "uri": "/jwe_test/v1/chat/completions",
            "methods": ["POST"],
            "upstream": {
              "type": "roundrobin",
              "nodes": {
                "httpbin.org": 1
              },
              "timeout": {
                "connect": 60,
                "send": 60,
                "read": 60
              }
            },
            "plugins": {
              "jwe-decrypt": {
                "header": "Authorization",
                "forward_header": "Authorization"
              },
              "response-rewrite": {
                "headers": {
                  "remove": ["Content-Encoding"]
                }
              }
            }
          }
        ]
      }
    }
  ],
  "environments": {
    "common": {
      "secrets": {
        "groq_api_key": "config:api_keys.groq"
      }
    },
    "development": {
      "secrets": {
        "jwt_secret_key": "your-secret-key-here",
        "jwe_encryption_key": "-secret-length-must-be-32-chars-",
        "langfuse_public_key": "${LANGFUSE_PUBLIC_KEY}",
        "langfuse_secret_key": "${LANGFUSE_SECRET_KEY}"
      },
      "urls": {
        "groq_base_url": "api.groq.com",
        "api_base_url": "http://localhost:8000",
        "jwt_service_url": "http://localhost:5000",
        "langfuse_host": "https://cloud.langfuse.com",
        "langfuse_otel_endpoint": "https://cloud.langfuse.com/api/public/otel/v1/traces"
      }
    }
  }
}